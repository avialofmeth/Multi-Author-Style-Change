I'm not sure if he knew what was going to happen (i lean toward it being an om the spot ambush rather then planned), but he did know one of their number was and so undermined the surrender process more then I imagine he was willing to risk. But play stupid games win stupid prizes.